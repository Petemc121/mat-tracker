{"ast":null,"code":"import _defineProperty from\"/home/peter/Documents/mat-tracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/defineProperty\";import _objectSpread from\"/home/peter/Documents/mat-tracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _regeneratorRuntime from\"/home/peter/Documents/mat-tracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/peter/Documents/mat-tracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/peter/Documents/mat-tracker/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import{useState,useEffect}from\"react\";import{Link}from\"react-router-dom\";import{getMembers}from\"../MatTrackerDAO/MatTrackerData\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";export default function CreateMemberPage(_ref){var handleChange=_ref.handleChange,handleSubmit=_ref.handleSubmit,_ref$getMembersFuncti=_ref.getMembersFunction,getMembersFunction=_ref$getMembersFuncti===void 0?getMembers:_ref$getMembersFuncti,setMembers=_ref.setMembers;var _useState=useState({member_name:\"\",member_phone:\"\",member_belt:\"\",member_joined_at:\"\"}),_useState2=_slicedToArray(_useState,2),memberInput=_useState2[0],setMemberInput=_useState2[1];var _useState3=useState(false),_useState4=_slicedToArray(_useState3,2),memberAdded=_useState4[0],setMemberAdded=_useState4[1];var date=new Date();var month=date.getMonth()+1;var dateInput=date.getFullYear()+\"-\"+month+\"-\"+date.getDate();console.log(memberInput);useEffect(function(){function addMember(){return _addMember.apply(this,arguments);}function _addMember(){_addMember=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var body,response,response2;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(!Object.values(memberInput).every(function(key){return key!==\"\";})){_context.next=18;break;}_context.prev=1;//proxy is only used in developement so it will be ignored in production builds\n//so if there is no localhost then by default it will use heroku\n//remember this heroku app is just our server serving the build static content and also holding the restful api\nbody=memberInput;_context.next=5;return fetch(\"/members\",{method:\"POST\",headers:{\"Content-type\":\"application/json\"},body:JSON.stringify(body)});case 5:response=_context.sent;_context.next=8;return getMembersFunction({name:\"\"});case 8:response2=_context.sent;setMembers(response2);console.log(response);memberInput={};setMemberAdded(true);_context.next=18;break;case 15:_context.prev=15;_context.t0=_context[\"catch\"](1);console.log(_context.t0);case 18:case\"end\":return _context.stop();}}},_callee,null,[[1,15]]);}));return _addMember.apply(this,arguments);}addMember();},[memberInput]);if(handleSubmit===undefined){handleSubmit=function handleSubmit(e){e.preventDefault();if(memberInput.member_name===\"\"){alert(\"please enter your name\");return;}if(memberInput.member_phone===\"\"){alert(\"please enter your phone number\");return;}else{if(isNaN(parseInt(memberInput.member_phone))){alert(\"please only enter numbers in phone field\");return;}if(memberInput.member_phone.length<10||memberInput.member_phone.length>11){alert(\"Your phone number is not valid\");return;}}if(memberInput.member_belt===\"\"){setMemberInput(function(values){return _objectSpread(_objectSpread({},values),{},{member_belt:\"white\"});});}if(memberInput.member_joined_at===\"\"){setMemberInput(function(values){return _objectSpread(_objectSpread({},values),{},{member_joined_at:dateInput});});}console.log(memberInput);};}if(handleChange===undefined){handleChange=function handleChange(event){var name=event.target.name;var value=event.target.value;setMemberInput(function(values){return _objectSpread(_objectSpread({},values),{},_defineProperty({},name,value));});};}return/*#__PURE__*/_jsxs(\"div\",{id:\"memberInputFormContainer\",children:[/*#__PURE__*/_jsxs(\"form\",{id:\"memberInputForm\",style:{display:memberAdded?\"none\":\"block\"},children:[/*#__PURE__*/_jsxs(\"div\",{className:\"memberInputElement\",children:[\"Name:\",/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,name:\"member_name\",className:\"memberInput\",\"data-testid\":\"name\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"memberInputElement\",children:[\"Phone number:\",/*#__PURE__*/_jsx(\"input\",{onChange:handleChange,name:\"member_phone\",className:\"memberInput\",\"data-testid\":\"phone\"})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"memberInputElement\",children:[\"Belt:\",/*#__PURE__*/_jsxs(\"select\",{onChange:handleChange,name:\"member_belt\",\"data-testid\":\"beltInput\",className:\"memberInput\",children:[/*#__PURE__*/_jsx(\"option\",{value:\"white\",children:\"white\"}),/*#__PURE__*/_jsx(\"option\",{value:\"blue\",children:\"blue\"}),/*#__PURE__*/_jsx(\"option\",{value:\"purple\",children:\"purple\"}),/*#__PURE__*/_jsx(\"option\",{value:\"brown\",children:\"brown\"}),/*#__PURE__*/_jsx(\"option\",{value:\"black\",children:\"black\"})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"memberInputElement\",children:[\"Joined:\",/*#__PURE__*/_jsx(\"input\",{name:\"member_joined_at\",className:\"memberInput\",type:\"date\",\"data-testid\":\"joined\",onChange:handleChange,defaultValue:dateInput})]}),/*#__PURE__*/_jsx(\"input\",{\"data-testid\":\"submit\",onClick:handleSubmit,type:\"submit\"})]}),/*#__PURE__*/_jsx(Link,{className:\"homeLink\",to:\"/\",children:\"Home\"}),/*#__PURE__*/_jsxs(\"div\",{id:\"memberAddedNotification\",style:{display:memberAdded?\"flex\":\"none\"},children:[/*#__PURE__*/_jsx(\"h3\",{id:\"memberAddedMessage\",children:\"Member added! Navigate back to home.\"}),/*#__PURE__*/_jsx(Link,{className:\"homeLink\",to:\"/\",children:\"Home\"})]})]});}","map":{"version":3,"sources":["/home/peter/Documents/mat-tracker/client/src/pages/CreateMemberPage.tsx"],"names":["useState","useEffect","Link","getMembers","CreateMemberPage","handleChange","handleSubmit","getMembersFunction","setMembers","member_name","member_phone","member_belt","member_joined_at","memberInput","setMemberInput","memberAdded","setMemberAdded","date","Date","month","getMonth","dateInput","getFullYear","getDate","console","log","addMember","Object","values","every","key","body","fetch","method","headers","JSON","stringify","response","name","response2","undefined","e","preventDefault","alert","isNaN","parseInt","length","event","target","value","display"],"mappings":"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","sourcesContent":["import { parse } from \"querystring\";\nimport { useState, useEffect } from \"react\";\nimport { Link } from \"react-router-dom\";\nimport { getMembers } from \"../MatTrackerDAO/MatTrackerData\";\nimport {\n  getMembersResponse,\n  getMembersInput,\n} from \"../MatTrackerDAO/MatTrackerDataTypes\";\n\ntype CreateMemberPageInput = {\n  handleChange?: (event: any) => void;\n  handleSubmit?: (event: any) => void;\n  getMembersFunction?: ({\n    name,\n  }: getMembersInput) => Promise<getMembersResponse[]>;\n  setMembers?: any;\n};\n\nexport default function CreateMemberPage({\n  handleChange,\n  handleSubmit,\n  getMembersFunction = getMembers,\n  setMembers,\n}: CreateMemberPageInput) {\n  let [memberInput, setMemberInput] = useState<any>({\n    member_name: \"\",\n    member_phone: \"\",\n    member_belt: \"\",\n    member_joined_at: \"\",\n  });\n  const [memberAdded, setMemberAdded] = useState(false);\n  const date = new Date();\n  const month = date.getMonth() + 1;\n  const dateInput = date.getFullYear() + \"-\" + month + \"-\" + date.getDate();\n  console.log(memberInput);\n  useEffect(() => {\n    async function addMember() {\n      if (Object.values(memberInput).every((key) => key !== \"\")) {\n        try {\n          //proxy is only used in developement so it will be ignored in production builds\n          //so if there is no localhost then by default it will use heroku\n          //remember this heroku app is just our server serving the build static content and also holding the restful api\n\n          const body = memberInput;\n          const response = await fetch(\"/members\", {\n            method: \"POST\",\n            headers: { \"Content-type\": \"application/json\" },\n            body: JSON.stringify(body),\n          });\n\n          const response2 = await getMembersFunction({ name: \"\" });\n          setMembers(response2);\n          console.log(response);\n          memberInput = {};\n          setMemberAdded(true);\n        } catch (error) {\n          console.log(error);\n        }\n      }\n    }\n    addMember();\n  }, [memberInput]);\n\n  if (handleSubmit === undefined) {\n    handleSubmit = (e: any) => {\n      e.preventDefault();\n\n      if (memberInput.member_name === \"\") {\n        alert(\"please enter your name\");\n        return;\n      }\n\n      if (memberInput.member_phone === \"\") {\n        alert(\"please enter your phone number\");\n        return;\n      } else {\n        if (isNaN(parseInt(memberInput.member_phone))) {\n          alert(\"please only enter numbers in phone field\");\n          return;\n        }\n\n        if (\n          memberInput.member_phone.length < 10 ||\n          memberInput.member_phone.length > 11\n        ) {\n          alert(\"Your phone number is not valid\");\n          return;\n        }\n      }\n\n      if (memberInput.member_belt === \"\") {\n        setMemberInput((values: {}) => ({ ...values, member_belt: \"white\" }));\n      }\n      if (memberInput.member_joined_at === \"\") {\n        setMemberInput((values: {}) => ({\n          ...values,\n          member_joined_at: dateInput,\n        }));\n      }\n      console.log(memberInput);\n    };\n  }\n\n  if (handleChange === undefined) {\n    handleChange = (event: any) => {\n      const name = event.target.name;\n      const value = event.target.value;\n      setMemberInput((values: {}) => ({ ...values, [name]: value }));\n    };\n  }\n\n  return (\n    <div id=\"memberInputFormContainer\">\n      <form\n        id=\"memberInputForm\"\n        style={{ display: memberAdded ? \"none\" : \"block\" }}\n      >\n        <div className=\"memberInputElement\">\n          Name:\n          <input\n            onChange={handleChange}\n            name=\"member_name\"\n            className=\"memberInput\"\n            data-testid=\"name\"\n          ></input>\n        </div>\n        <div className=\"memberInputElement\">\n          Phone number:\n          <input\n            onChange={handleChange}\n            name=\"member_phone\"\n            className=\"memberInput\"\n            data-testid=\"phone\"\n          ></input>\n        </div>\n        <div className=\"memberInputElement\">\n          Belt:\n          <select\n            onChange={handleChange}\n            name=\"member_belt\"\n            data-testid=\"beltInput\"\n            className=\"memberInput\"\n          >\n            <option value=\"white\">white</option>\n            <option value=\"blue\">blue</option>\n            <option value=\"purple\">purple</option>\n            <option value=\"brown\">brown</option>\n            <option value=\"black\">black</option>\n          </select>\n        </div>\n        <div className=\"memberInputElement\">\n          Joined:\n          <input\n            name=\"member_joined_at\"\n            className=\"memberInput\"\n            type=\"date\"\n            data-testid=\"joined\"\n            onChange={handleChange}\n            defaultValue={dateInput}\n          />\n        </div>\n        <input data-testid=\"submit\" onClick={handleSubmit} type=\"submit\" />\n      </form>\n\n      <Link className=\"homeLink\" to=\"/\">\n        Home\n      </Link>\n      <div\n        id=\"memberAddedNotification\"\n        style={{ display: memberAdded ? \"flex\" : \"none\" }}\n      >\n        <h3 id=\"memberAddedMessage\">Member added! Navigate back to home.</h3>\n\n        <Link className=\"homeLink\" to=\"/\">\n          Home\n        </Link>\n      </div>\n    </div>\n  );\n}\n"]},"metadata":{},"sourceType":"module"}